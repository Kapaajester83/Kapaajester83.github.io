<!DOCTYPE html>
<html lang="en-US">

<head>
  <link rel="icon" type="image/png" sizes="48x48" href="../../../favicon.ico">
  <link rel="shortcut icon" href="../../../favicon.ico">
  <title>Over The Wire | Bandit</title>
  <meta name="author" content="Kappa">
  <meta name="description" content="Splash">
  <meta name="viewport" content="width=device-width">
  <link href='https://fonts.googleapis.com/css?family=Rock+Salt' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Orbitron:500' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Rochester' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="../../labs.css" type="text/css">
</head>

<body>

  <!--
  _  __          _____  _____        
 | |/ /    /\   |  __ \|  __ \ /\    
 | ' /    /  \  | |__) | |__) /  \   
 |  <    / /\ \ |  ___/|  ___/ /\ \  
 | . \  / ____ \| |    | |  / ____ \ 
 |_|\_\/_/    \_\_|    |_| /_/    \_\
 
 -->

  <div id="page">
    <div id="nav">
      <ul>
        <li><a href="https://kapaajester83.github.io/">Home</a></li>
        <li><a href="https://kapaajester83.github.io/labs/contents.html">Labs</a></li>
        <li><a href="https://duckduckgo.com/" target="_blank">DuckGo</a></li>
        <li><a href="https://github.com/Kapaajester83?tab=repositories" target="_blank">About</a></li>
        <li><a href="mailto:kappajester83@gmail.com" target="_blank">Email</a></li>
      </ul>
    </div>
    <div id="logo">
      <img src="https://kapaajester83.github.io/logo.jpeg" alt="logo">
      <h1>Kappa</h1>

      <div>
        <br>
        <br>
        <br>
        <h2>“Great things are not done by impulse, but by a series of small things brought together.”</h2>
        <br>
        <br>
      </div>
    </div>

    <div>
      <div id="writeup">
        <h3>
          <a href="../../contents.html">Over The Wire</a>
        </h3>
        <hr>

        <div id="labs-table">
          <h4><a href="../bandit.htm">Bandit</a></h4>
          <h4>Host: bandit.labs.overthewire.org</h4>
          <h4>Port: 2220</h4>
          <hr>

          <ul>
            <li><a href="bandit19.htm">Level 19</a></li>
            <li><a href="bandit20.htm"><b><em>~ Level 20</em></b></a></li>
            <li><a href="bandit21.htm">Level 21</a></li>
          </ul>
          <hr>

        </div>

        <h3>Level 20</h3>

        <h5>ssh bandit20@bandit.labs.overthewire.org -p 2220<br>
          password: VxCazJaVykI6W36BkBU0mJTCM8rR95XT
        </h5>

        <h4>Objective:</h4>

        <p>There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).</p>

        <p>NOTE: Try connecting to your own network daemon to see if it works as you think.</p>

        <p>To create a one-time server, send one message then disconnect, we use "|" and echo. Netcat will create a connection in server mode that listens for an inbound connecter.
        <ul>
          <li>-l means listening</li>
          <li>-n prevents newline charactor</li>
          <li>& to run in background</li>
        </ul>

        <h4>CLI:</h4>

        <h5>
          bandit20@bandit:~$ echo -n 'VxCazJaVykI6W36BkBU0mJTCM8rR95XT' | nc -l -p 1234 &[1] 1356183<br>
          <br>
          bandit20@bandit:~$ ./suconnect 1234<br>
          Could not connect ...<br>
          [1]+ Done<br>
          echo -n 'VxCazJaVykI6W36BkBU0mJTCM8rR95XT' | nc -l -p 1234<br>
          <br>
          bandit20@bandit:~$ echo -n 'VxCazJaVykI6W36BkBU0mJTCM8rR95XT' | nc -l -p 1234 & [1] 1357707<br>
          <br>
          bandit20@bandit:~$ ./suconnect 1234<br>
          Read: VxCazJaVykI6W36BkBU0mJTCM8rR95XT<br>
          Password matches, sending next password<br>
          NvEJF7oVjkddltPSrdKEFOllh9V1IBcq<br>
          bandit20@bandit:~$
        </h5>
        <hr>

        <div>
          <h4><a href="../bandit.htm">Bandit</a></h4>
          <ul>
            <li><a href="bandit0.htm">Level 0</a></li>
            <li><a href="bandit1.htm">Level 1</a></li>
            <li><a href="bandit2.htm">Level 2</a></li>
            <li><a href="bandit3.htm">Level 3</a></li>
            <li><a href="bandit4.htm">Level 4</a></li>
            <li><a href="bandit5.htm">Level 5</a></li>
            <li><a href="bandit6.htm">Level 6</a></li>
            <li><a href="bandit7.htm">Level 7</a></li>
            <li><a href="bandit8.htm">Level 8</a></li>
            <li><a href="bandit9.htm">Level 9</a></li>
            <li><a href="bandit10.htm">Level 10</a></li>
            <li><a href="bandit11.htm">Level 11</a></li>
            <li><a href="bandit12.htm">Level 12</a></li>
            <li><a href="bandit13.htm">Level 13</a></li>
            <li><a href="bandit14.htm">Level 14</a></li>
            <li><a href="bandit15.htm">Level 15</a></li>
            <li><a href="bandit16.htm">Level 16</a></li>
            <li><a href="bandit17.htm">Level 17</a></li>
            <li><a href="bandit18.htm">Level 18</a></li>
            <li><a href="bandit18.htm">Level 19</a></li>
            <li><a href="bandit20.htm"><b><em>~ Level 20</em></b></a></li>
            <li><a href="bandit21.htm">Level 21</a></li>
          </ul>
        </div>
        <hr>
        
      </div>
    </div>
  </div>

  <div id="footer">
    <p>
      Webpage made by <a href="mailto:kappajester83@gmail.com">Kappa </a>
    </p>
  </div>

</html>