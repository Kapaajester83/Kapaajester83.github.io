<!DOCTYPE html>
<html lang="en-US">

<head>
  <link rel="icon" type="image/png" sizes="48x48" href="../../../favicon.ico">
  <link rel="shortcut icon" href="../../../favicon.ico">
  <title>Over The Wire | Krypton</title>
  <meta name="author" content="Kappa">
  <meta name="description" content="Splash">
  <meta name="viewport" content="width=device-width">
  <link href='https://fonts.googleapis.com/css?family=Rock+Salt' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Orbitron:500' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Rochester' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="../../labs.css" type="text/css">
</head>

<body>

  <!--
  _  __          _____  _____        
 | |/ /    /\   |  __ \|  __ \ /\    
 | ' /    /  \  | |__) | |__) /  \   
 |  <    / /\ \ |  ___/|  ___/ /\ \  
 | . \  / ____ \| |    | |  / ____ \ 
 |_|\_\/_/    \_\_|    |_| /_/    \_\
 -->

  <div id="page">
    <div id="nav">
      <ul>
        <li><a href="https://kapaajester83.github.io/">Home</a></li>
        <li><a href="https://kapaajester83.github.io/labs/contents.html">Labs</a></li>
        <li><a href="https://duckduckgo.com/" target="_blank">DuckGo</a></li>
        <li><a href="https://github.com/Kapaajester83?tab=repositories" target="_blank">About</a></li>
        <li><a href="mailto:kappajester83@gmail.com" target="_blank">Email</a></li>
      </ul>
    </div>
    <div id="logo">
      <img src="https://kapaajester83.github.io/logo.jpeg" alt="logo">
      <h1>Kappa</h1>

      <div>
        <br>
        <br>
        <br>
        <h2>“Great things are not done by impulse, but by a series of small things brought together.”</h2>
        <br>
        <br>
      </div>
    </div>

    <div>
      <div id="writeup">
        <h3>
          <a href="../../contents.html">Over The Wire</a>
        </h3>
        <hr>

        <div id="labs-table">
          <h4><a href="../krypton.htm">Krypton</a></h4>
          <ul>
            <li><a href="krypton1.htm">Level 1</a></li>
            <li><a href="krypton2.htm"><b><em>~ Level 2</em></b></a></li>
            <li><a href="krypton3.htm">Level 3</a></li>
          </ul>
        </div>
        <hr>

        <div>
          <h4>Host: krypton.labs.overthewire.org</h4>
          <h4>Port: 2231</h4>
        </div>
        <hr>

        <div>

          <h3><em>Krypton Level 2</em></h3>

          <h5>
            ssh krypton2@krypton.labs.overthewire.org -p 2231<br>
            ROTTEN
          </h5>

          <h4>Objective</h4>

          <p>ROT13 is a simple substitution cipher.</p>

          <p>Substitution ciphers are a simple replacement algorithm. In this example of a substitution cipher, we will explore a ‘monoalphebetic’ cipher. Monoalphebetic means, literally, “one alphabet” and you will see why.</p>

          <p>This level contains an old form of cipher called a ‘Caesar Cipher’. A Caesar cipher shifts the alphabet by a set number. For example:
          <ul>
            <li>plain: a b c d e f g h i j k ...</li>
            <li>cipher: G H I J K L M N O P Q ...</li>
          </ul>

          <p>In this example, the letter ‘a’ in plaintext is replaced by a ‘G’ in the ciphertext so, for example, the plaintext ‘bad’ becomes ‘HGJ’ in ciphertext.</p>

          <p>The password for level 3 is in the file krypton3. It is in 5 letter group ciphertext. It is encrypted with a Caesar Cipher. Without any further information, this cipher text may be difficult to break. You do not have direct access to the key, however you do have access to a program that will encrypt anything you wish to give it using the key. If you think logically, this is completely easy.</p>

          <p>One shot can solve it!</p>

          <p>Have fun.</p>

          <h4>Additional Information:</h4>

          <p>The encrypt binary will look for the keyfile in your current working directory. Therefore, it might be best to create a working direcory in /tmp and in there a link to the keyfile. As the encrypt binary runs setuid krypton3, you also need to give krypton3 access to your working directory.</p>

          <p>Here is an example:</p>

          <h5>
            krypton2@melinda:~$ mktemp -d<br>
            /tmp/tmp.Wf2OnCpCDQ<br>
            krypton2@melinda:~$ cd /tmp/tmp.Wf2OnCpCDQ<br>
            krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ ln -s /krypton/krypton2/keyfile.dat<br>
            krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ ls<br>
            keyfile.dat<br>
            krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ chmod 777 .<br>
            krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ /krypton/krypton2/encrypt /etc/issue<br>
            krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ ls<br>
            ciphertext keyfile.dat
          </h5>

          <h4>CLI</h4>

          <h5>
            kali@Kali:~$ ssh krypton2@krypton.labs.overthewire.org -p 2231<br>
            krypton2@krypton.labs.overthewire.org's password: <br>
            <br>
            Welcome to OverTheWire!<br>
            Enjoy your stay!<br>
            <br>
            krypton2@bandit:~$ cd /krypton/krypton2/<br>
            krypton2@bandit:/krypton/krypton2$ ls -la<br>
            total 36<br>
            drwxr-xr-x 2 root root 4096 Sep 19 07:09 .<br>
            drwxr-xr-x 9 root root 4096 Sep 19 07:10 ..<br>
            -rwsr-x--- 1 krypton3 krypton2 16328 Sep 19 07:09 encrypt<br>
            -rw-r----- 1 krypton3 krypton3 27 Sep 19 07:09 keyfile.dat<br>
            -rw-r----- 1 krypton2 krypton2 13 Sep 19 07:09 krypton3<br>
            -rw-r----- 1 krypton2 krypton2 1815 Sep 19 07:09 README<br>
            krypton2@bandit:/krypton/krypton2$ mktemp -d<br>
            /tmp/tmp.ZPMdgW6riw<br>
            krypton2@bandit:/krypton/krypton2$ cd /tmp/tmp.ZPMdgW6riw<br>
            krypton2@bandit:/tmp/tmp.ZPMdgW6riw$ ln -s /krypton/krypton2/keyfile.dat<br>
            krypton2@bandit:/tmp/tmp.ZPMdgW6riw$ chmod 777 .<br>
            krypton2@bandit:/tmp/tmp.ZPMdgW6riw$ echo "AAAAA" > encrypt.txt<br>
            krypton2@bandit:/tmp/tmp.ZPMdgW6riw$ /krypton/krypton2/encrypt encrypt.txt<br>
            krypton2@bandit:/tmp/tmp.ZPMdgW6riw$ ls -la<br>
            total 13588<br>
            drwxrwxrwx 2 krypton2 krypton2 4096 Nov 30 17:36 .<br>
            drwxrwx-wt 1 root root 13897728 Nov 30 17:36 ..<br>
            -rw-rw-r-- 1 krypton3 krypton2 5 Nov 30 17:36 ciphertext<br>
            -rw-rw-r-- 1 krypton2 krypton2 6 Nov 30 17:35 encrypt.txt<br>
            lrwxrwxrwx 1 krypton2 krypton2 29 Nov 30 17:34 keyfile.dat -> /krypton/krypton2/keyfile.dat<br>
            krypton2@bandit:/tmp/tmp.ZPMdgW6riw$ cat ciphertext<br>
            MMMMMkrypton2@bandit:/tmp/tmp.ZPMdgW6riw$ <br>
            krypton2@bandit:/tmp/tmp.ZPMdgW6riw$ cat /krypton/krypton2/krypton3 | tr a-zA-Z o-za-nO-ZA-N<br>
            CAESARISEASY<br>
            krypton2@bandit:/tmp/tmp.ZPMdgW6riw$
          </h5>

        </div>
        <hr>

        <div>
          <h4><a href="../krypton.htm">Krypton</a></h4>
          <ol>
            <li><a href="krypton0.htm">Level 0</a></li>
            <li><a href="krypton1.htm">Level 1</a></li>
            <li><a href="krypton2.htm"><b><em>~ Level 2</em></b></a></li>
            <li><a href="krypton3.htm">Level 3</a></li>
          </ol>
        </div>
        <hr>

      </div>
    </div>
  </div>

  <div id="footer">
    <p>
      Webpage made by <a href="mailto:kappajester83@gmail.com">Kappa </a>
    </p>
  </div>

</html>